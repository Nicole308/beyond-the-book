extends layout

block script
	script(src="https://cdn.tiny.cloud/1/kvagq5hrst0o3dqg4ewxrskd3dfgpmrqrunr0z84vlppp5jj/tinymce/5/tinymce.min.js" referrerpolicy="origin")
	script.
		tinymce.init({
			selector:  '#body',
			menubar: false,
			statusbar: false,
		})
block content
	<main>
	<article>
	h2= book.title
	h5 Written by #{author}
	label Genre: #{genre.genre}
	p Description: #{book.description}
	if book.link
		a(href=`${book.link}`,  target="_blank") Author's Link
		br
	hr
	if user
		if user.userName == book.authorName
			div
				| 
	if user
		h3(class="font-title") Add Page Section
		form(method='POST', action=`/books/${book.id}`, onsubmit="submitButton.disabled = true; return true;")
			div
				label Chapter Name:
				input(type="text", name='chapterName', value=`${(!prevChapter) ? '' : prevChapter}`, class="input")
			div
				label Page Number:
				input(type="number", name='pageNumber', value=`${prevPageNumber}`, min=1)
			div
				label Content:
				textarea#body(name='body')=prevBody
			div
				button(type="submit", class="buttonsmall", name="submitButton") Add Page
				| 
				a(href='/users/profile', class="buttonsmall") Cancel	
	</article> 

	<aside class="info2">
	if user
		if user.userName == book.authorName
			div
				a(href=`/books/modify/${book.id}`, class="buttoncore-update") Modify Book
				| 
				a(href='#', id="delete", data-id=`${book.id}`, class="buttoncore-delete") Delete Book	
	h3 Book Chapter
	if !book.pages
		div
			each pg, i in page
				div
					a(href="/books/page/"+pg.id)= pg.chapterName
					| 
					if user
						if user.userName == book.authorName
							if (pg.histories.length > 0)
								span - #{(pg.histories.length)} Pending Approval Requests
	</aside> 
	</main> 
	script(src='/javascripts/delete_book.js')